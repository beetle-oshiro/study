{% extends "base.html" %}

{% block title %}å­¦ç¿’è¨˜éŒ²ãƒ•ã‚©ãƒ¼ãƒ {% endblock %}

{% block content %}
<div class="container mt-5" style="max-width: 700px;">
    <!-- ã‚«ãƒ¼ãƒ‰ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’å›²ã‚€ -->
    <div class="card shadow-sm p-4 mb-4">
        <form method="POST">
            <div class="mb-3">
                <label for="id_text_name" class="form-label">ã‚ãªãŸã®åå‰ï¼š</label>
                <input type="text" class="form-control" name="name" id="id_text_name" value="{{ name }}">
            </div>

            <div class="mb-3">
                <label for="id_select_category" class="form-label">ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼š</label>
                <select name="category" id="id_select_category" class="form-select">
                    <option value="å­¦ç¿’" {% if category=="å­¦ç¿’" %}selected{% endif %}>å­¦ç¿’</option>
                    <option value="é›‘è«‡" {% if category=="é›‘è«‡" %}selected{% endif %}>é›‘è«‡</option>
                    <option value="æ—¥è¨˜" {% if category=="æ—¥è¨˜" %}selected{% endif %}>æ—¥è¨˜</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="id_text_message" class="form-label">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼š</label>
                <textarea name="message" id="id_text_message" class="form-control">{{ message }}</textarea>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-primary">è¨˜éŒ²ã™ã‚‹</button>
            </div>
        </form>
    </div>

    <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
    {% if error %}
    <div class="alert alert-danger" role="alert">
        âš ï¸ {{ error }}
    </div>
    {% endif %}

    <h3>ğŸ“šã“ã‚Œã¾ã§ã®è¨˜éŒ²</h3>
    <p><small>â€»ã“ã®ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸã®ã¯ï¼š{{ timestamp }}</small></p>

    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»æ¤œç´¢ -->
    <form method="GET" action="/" class="mb-3">
        <div class="d-flex flex-wrap gap-2">
            <button name="filter" value="all" class="btn btn-outline-secondary">ã™ã¹ã¦</button>
            <button name="filter" value="å­¦ç¿’" class="btn btn-outline-secondary">å­¦ç¿’</button>
            <button name="filter" value="é›‘è«‡" class="btn btn-outline-secondary">é›‘è«‡</button>
            <button name="filter" value="æ—¥è¨˜" class="btn btn-outline-secondary">æ—¥è¨˜</button>
        </div>
    </form>

    <form method="GET" action="/" class="mb-3">
        <div class="input-group">
            <input type="text" name="keyword" class="form-control" placeholder="ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢" value="{{ keyword }}">
            <button class="btn btn-outline-primary" type="submit">æ¤œç´¢</button>
        </div>
    </form>

    <form method="GET" action="/" class="mb-4">
        <input type="hidden" name="filter" value="{{ filter }}">
        <input type="hidden" name="keyword" value="{{ keyword }}">
        <button name="sort" value="time" class="btn btn-sm btn-outline-dark">ğŸ•’ æ–°ã—ã„é †</button>
        <button name="sort" value="name" class="btn btn-sm btn-outline-dark">ğŸ”¤ åå‰é †</button>
    </form>

    <!-- è¨˜éŒ²ä¸€è¦§ -->
    {% if data %}
    <ul class="list-group">
        {% for id, item in data.items() %}
        <li class="list-group-item">
            <strong>{{ id }}. {{ item.name }}</strong>ï¼š{{ item.category }} - {{ item.message }}<br>
            <small class="text-muted">é€ä¿¡æ™‚åˆ»ï¼š{{ item.time }}</small>
            <div class="mt-2">
                <form method="POST" action="/delete/{{ id }}" style="display:inline;">
                    <button type="submit" class="btn btn-sm btn-danger">å‰Šé™¤</button>
                </form>
                <form method="GET" action="/edit/{{ id }}" style="display:inline;">
                    <button type="submit" class="btn btn-sm btn-secondary">ç·¨é›†</button>
                </form>
            </div>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>ã¾ã è¨˜éŒ²ã¯ã‚ã‚Šã¾ã›ã‚“ï¼</p>
    {% endif %}
</div>
{% endblock %}